import{u as $,r as s,i as V,R as c,j as e,k as _,h as B,f as H,a as C,n as U,T as E}from"./index-Dh2HMBa2.js";import{C as z}from"./Dashboard-CFLZ1FYc.js";const L={title:"",type:V.Call,dateTime:new Date().toISOString().slice(0,16),relatedTo:"",assignedTo:""},K=({isOpen:g,onClose:N,onSuccess:x,sellers:M,prospects:b,members:F})=>{const{user:o}=$(),[l,w]=s.useState(L),[n,a]=s.useState({}),[v,A]=s.useState(!1),[h,D]=s.useState("single"),[y,G]=s.useState("all"),[j,P]=s.useState("all"),[p,u]=s.useState([]),f=s.useMemo(()=>h==="massive"&&!l.assignedTo?[]:b.filter(r=>{if(!(!l.assignedTo||r.assignedTo===l.assignedTo))return!1;const m=y==="all"||r.stage===y,k=j==="all"||r.source===j;return m&&k}),[b,y,j,l.assignedTo,h]),O=()=>{w(L),a({}),D("single"),G("all"),P("all"),u([])};s.useEffect(()=>{(o==null?void 0:o.role)===c.Seller&&w(r=>({...r,assignedTo:o.id})),g||O()},[g,o]),s.useEffect(()=>{u([])},[f]);const R=()=>{const r={};return l.title.trim()||(r.title="El título es obligatorio."),l.dateTime||(r.dateTime="La fecha y hora son obligatorias."),l.assignedTo||(r.assignedTo="Debe asignar un vendedor."),h==="single"&&!l.relatedTo?r.relatedTo="Debe relacionar la tarea a un prospecto o socio.":h==="massive"&&p.length===0&&(r.massAssignment="Debe seleccionar al menos un prospecto."),a(r),Object.keys(r).length===0},T=r=>{const{name:d,value:m}=r.target;w(k=>({...k,[d]:m}))},I=r=>{r.target.checked?u(f.map(d=>d.id)):u([])},S=(r,d)=>{r.target.checked?u(m=>[...m,d]):u(m=>m.filter(k=>k!==d))},t=async r=>{if(r.preventDefault(),!!R()){A(!0);try{const d={title:l.title,type:l.type,dateTime:l.dateTime,assignedTo:l.assignedTo};if(h==="single")await C.addTask({...d,relatedTo:l.relatedTo});else{const m=p.map(k=>C.addTask({...d,relatedTo:k}));await Promise.all(m)}x()}catch(d){console.error("Failed to add task(s)",d)}finally{A(!1)}}},i=()=>v?"Creando...":h==="massive"?`Crear ${p.length>0?p.length:""} Tarea(s)`:"Crear Tarea";return g?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60","aria-modal":"true",role:"dialog",children:e.jsx("div",{className:"bg-brand-surface border border-brand-border rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] flex flex-col m-4",children:e.jsxs("form",{onSubmit:t,className:"flex flex-col h-full",children:[e.jsxs("div",{className:"p-6 border-b border-brand-border",children:[e.jsx("h2",{className:"text-2xl font-bold text-brand-text-primary",children:"Crear Nueva Tarea"}),e.jsx("p",{className:"text-sm text-brand-text-secondary",children:"Completa los detalles y a quién(es) se relaciona."})]}),e.jsxs("div",{className:"flex-1 p-6 overflow-y-auto grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-4 flex flex-col",children:[e.jsx("h3",{className:"text-lg font-semibold text-brand-text-primary border-b border-brand-border pb-2",children:"Detalles de la Tarea"}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"title",className:"block text-sm font-medium text-brand-text-secondary",children:"Título"}),e.jsx("input",{type:"text",name:"title",id:"title",value:l.title,onChange:T,className:`mt-1 block w-full bg-brand-bg border rounded-md shadow-sm p-2 text-brand-text-primary focus:ring-brand-primary focus:border-brand-primary ${n.title?"border-red-500":"border-brand-border"}`}),n.title&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:n.title})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"dateTime",className:"block text-sm font-medium text-brand-text-secondary",children:"Fecha y Hora"}),e.jsx("input",{type:"datetime-local",name:"dateTime",id:"dateTime",value:l.dateTime,onChange:T,className:`mt-1 block w-full bg-brand-bg border rounded-md shadow-sm p-2 text-brand-text-primary focus:ring-brand-primary focus:border-brand-primary ${n.dateTime?"border-red-500":"border-brand-border"}`}),n.dateTime&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:n.dateTime})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"type",className:"block text-sm font-medium text-brand-text-secondary",children:"Tipo"}),e.jsx("select",{name:"type",id:"type",value:l.type,onChange:T,className:"mt-1 block w-full bg-brand-bg border border-brand-border rounded-md shadow-sm p-2 text-brand-text-primary focus:ring-brand-primary focus:border-brand-primary capitalize",children:_.map(r=>e.jsx("option",{value:r,className:"capitalize",children:r},r))})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"assignedTo",className:"block text-sm font-medium text-brand-text-secondary",children:"Asignar a"}),(o==null?void 0:o.role)===c.Seller?e.jsx("div",{className:"mt-1 block w-full bg-gray-700 border border-brand-border rounded-md shadow-sm p-2 text-brand-text-primary",children:o.name}):e.jsxs(e.Fragment,{children:[e.jsxs("select",{name:"assignedTo",id:"assignedTo",value:l.assignedTo,onChange:T,className:`mt-1 block w-full bg-brand-bg border rounded-md shadow-sm p-2 text-brand-text-primary focus:ring-brand-primary focus:border-brand-primary ${n.assignedTo?"border-red-500":"border-brand-border"}`,children:[e.jsx("option",{value:"",children:"Seleccionar vendedor..."}),M.map(r=>e.jsx("option",{value:r.id,children:r.name},r.id))]}),n.assignedTo&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:n.assignedTo})]})]})]}),e.jsxs("div",{className:"space-y-4 flex flex-col",children:[e.jsx("h3",{className:"text-lg font-semibold text-brand-text-primary border-b border-brand-border pb-2",children:"Relacionar Con"}),e.jsxs("div",{className:"flex border-b border-brand-border",children:[e.jsx("button",{type:"button",onClick:()=>D("single"),className:`py-2 px-4 text-sm font-medium ${h==="single"?"border-b-2 border-brand-primary text-brand-primary":"text-brand-text-secondary hover:bg-white/5"}`,children:"Individual"}),e.jsx("button",{type:"button",onClick:()=>D("massive"),className:`py-2 px-4 text-sm font-medium ${h==="massive"?"border-b-2 border-brand-primary text-brand-primary":"text-brand-text-secondary hover:bg-white/5"} disabled:opacity-50 disabled:cursor-not-allowed`,disabled:!l.assignedTo,children:"Masiva"})]}),e.jsxs("div",{className:"flex-1",children:[h==="single"&&e.jsxs("div",{children:[e.jsx("label",{htmlFor:"relatedTo",className:"block text-sm font-medium text-brand-text-secondary sr-only",children:"Relacionado con"}),e.jsxs("select",{name:"relatedTo",id:"relatedTo",value:l.relatedTo,onChange:T,className:`block w-full bg-brand-bg border rounded-md shadow-sm p-2 text-brand-text-primary focus:ring-brand-primary focus:border-brand-primary ${n.relatedTo?"border-red-500":"border-brand-border"}`,children:[e.jsx("option",{value:"",children:"Seleccionar Prospecto o Socio..."}),e.jsx("optgroup",{label:"Prospectos",children:b.map(r=>e.jsx("option",{value:r.id,children:r.name},r.id))}),e.jsx("optgroup",{label:"Socios",children:F.map(r=>e.jsx("option",{value:r.id,children:r.name},r.id))})]}),n.relatedTo&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:n.relatedTo})]}),h==="massive"&&e.jsxs("div",{className:"bg-brand-bg/50 p-4 border border-brand-border rounded-lg space-y-4 h-full flex flex-col",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"prospectStageFilter",className:"block text-xs font-medium text-brand-text-secondary",children:"Etapa"}),e.jsxs("select",{id:"prospectStageFilter",value:y,onChange:r=>G(r.target.value),className:"mt-1 block w-full p-2 border border-brand-border bg-brand-bg text-brand-text-primary rounded-md shadow-sm text-sm",children:[e.jsx("option",{value:"all",children:"Todas"}),B.map(r=>e.jsx("option",{value:r,children:r},r))]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"prospectSourceFilter",className:"block text-xs font-medium text-brand-text-secondary",children:"Origen"}),e.jsxs("select",{id:"prospectSourceFilter",value:j,onChange:r=>P(r.target.value),className:"mt-1 block w-full p-2 border border-brand-border bg-brand-bg text-brand-text-primary rounded-md shadow-sm text-sm",children:[e.jsx("option",{value:"all",children:"Todos"}),H.map(r=>e.jsx("option",{value:r,children:r},r))]})]})]}),e.jsxs("div",{className:"border-t border-brand-border pt-4 flex-1 flex flex-col",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("label",{className:"flex items-center text-sm font-medium text-brand-text-secondary",children:[e.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-brand-border bg-brand-surface text-brand-primary focus:ring-brand-primary",checked:f.length>0&&p.length===f.length,onChange:I,disabled:f.length===0}),e.jsxs("span",{className:"ml-2",children:["Seleccionar todos (",f.length,")"]})]}),e.jsxs("span",{className:"text-sm font-semibold text-brand-primary",children:[p.length," seleccionados"]})]}),e.jsx("div",{className:"flex-1 max-h-48 overflow-y-auto border border-brand-border rounded-md bg-brand-bg p-2 space-y-1",children:f.length>0?f.map(r=>e.jsxs("label",{className:"flex items-center p-1.5 rounded hover:bg-brand-surface cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-brand-border bg-brand-surface text-brand-primary focus:ring-brand-primary",checked:p.includes(r.id),onChange:d=>S(d,r.id)}),e.jsx("span",{className:"ml-3 text-sm text-brand-text-primary",children:r.name})]},r.id)):e.jsx("p",{className:"text-center text-sm text-brand-text-muted py-4",children:"No hay prospectos que coincidan con los filtros para el vendedor seleccionado."})}),n.massAssignment&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:n.massAssignment})]})]})]})]})]}),e.jsxs("div",{className:"px-6 py-4 bg-black/20 border-t border-brand-border flex justify-end gap-3 mt-auto",children:[e.jsx("button",{type:"button",onClick:N,className:"px-4 py-2 text-sm font-medium text-brand-text-primary bg-brand-border border border-transparent rounded-md shadow-sm hover:bg-gray-600",children:"Cancelar"}),e.jsx("button",{type:"submit",disabled:v,className:"px-4 py-2 text-sm font-medium text-white bg-brand-primary border border-transparent rounded-md shadow-sm hover:bg-brand-primary-hover disabled:opacity-50 min-w-[120px] text-center",children:i()})]})]})})}):null},W=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-brand-text-secondary",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),q=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-brand-text-secondary",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})}),Y=({isOpen:g,onClose:N})=>{const[x,M]=s.useState(""),[b,F]=s.useState(""),[o,l]=s.useState(null);s.useEffect(()=>{if(g){const n=localStorage.getItem("sportclub-crm-monthly-conversion-goal")||"";M(n);const a=localStorage.getItem("sportclub-crm-daily-conversion-goal")||"";F(a)}else l(null)},[g]);const w=()=>{l(null);let n=!1;const a=parseFloat(x);x!==""&&(isNaN(a)||a<0||a>100)&&(n=!0);const v=parseFloat(b);b!==""&&(isNaN(v)||v<0||v>100)&&(n=!0),n?(l({text:"Por favor, ingrese valores válidos entre 0 y 100.",type:"error"}),setTimeout(()=>l(null),3e3)):(localStorage.setItem("sportclub-crm-monthly-conversion-goal",x),localStorage.setItem("sportclub-crm-daily-conversion-goal",b),l({text:"Objetivos guardados con éxito.",type:"success"}),setTimeout(()=>{N()},1500))};return g?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60","aria-modal":"true",role:"dialog",children:e.jsxs("div",{className:"bg-brand-surface border border-brand-border rounded-lg shadow-xl w-full max-w-lg m-4",children:[e.jsxs("div",{className:"p-6 border-b border-brand-border",children:[e.jsx("h2",{className:"text-2xl font-bold text-brand-text-primary",children:"Establecer Objetivos de Conversión"}),e.jsx("p",{className:"text-sm text-brand-text-secondary",children:"Estas metas se usarán en los reportes para medir el rendimiento."})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-lg bg-brand-bg flex items-center justify-center border border-brand-border",children:e.jsx(W,{})}),e.jsxs("div",{className:"flex-grow",children:[e.jsx("label",{htmlFor:"monthlyConversionGoal",className:"block text-sm font-semibold text-brand-text-primary",children:"Meta de Conversión Mensual"}),e.jsx("p",{className:"text-xs text-brand-text-muted",children:"Objetivo de prospectos ganados para el mes actual."}),e.jsxs("div",{className:"relative mt-2",children:[e.jsx("input",{type:"number",id:"monthlyConversionGoal",value:x,onChange:n=>M(n.target.value),className:"block w-full p-2 border border-brand-border bg-brand-bg text-brand-text-primary rounded-md shadow-sm focus:ring-brand-primary focus:border-brand-primary pr-8",placeholder:"Ej: 25",min:"0",max:"100",step:"0.1"}),e.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none",children:e.jsx("span",{className:"text-gray-500 sm:text-sm",children:"%"})})]})]})]}),e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-lg bg-brand-bg flex items-center justify-center border border-brand-border",children:e.jsx(q,{})}),e.jsxs("div",{className:"flex-grow",children:[e.jsx("label",{htmlFor:"dailyConversionGoal",className:"block text-sm font-semibold text-brand-text-primary",children:"Meta de Conversión Diaria"}),e.jsx("p",{className:"text-xs text-brand-text-muted",children:"Objetivo de prospectos ganados para el día de hoy."}),e.jsxs("div",{className:"relative mt-2",children:[e.jsx("input",{type:"number",id:"dailyConversionGoal",value:b,onChange:n=>F(n.target.value),className:"block w-full p-2 border border-brand-border bg-brand-bg text-brand-text-primary rounded-md shadow-sm focus:ring-brand-primary focus:border-brand-primary pr-8",placeholder:"Ej: 30",min:"0",max:"100",step:"0.1"}),e.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none",children:e.jsx("span",{className:"text-gray-500 sm:text-sm",children:"%"})})]})]})]}),o&&e.jsx("p",{className:`text-center text-sm mt-2 ${o.type==="success"?"text-green-400":"text-red-500"}`,children:o.text})]}),e.jsxs("div",{className:"px-6 py-4 bg-black/20 border-t border-brand-border flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:N,className:"px-4 py-2 text-sm font-medium text-brand-text-primary bg-brand-border border border-transparent rounded-md shadow-sm hover:bg-gray-600",children:"Cancelar"}),e.jsx("button",{type:"button",onClick:w,className:"px-4 py-2 text-sm font-medium text-white bg-brand-primary border border-transparent rounded-md shadow-sm hover:bg-brand-primary-hover",children:"Guardar Objetivos"})]})]})}):null},J={[E.Pending]:"bg-amber-900/60 text-amber-200",[E.Done]:"bg-green-900/60 text-green-200"},Q=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),X=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-11a1 1 0 10-2 0v2H7a1 1 0 100 2h2v2a1 1 0 102 0v-2h2a1 1 0 100-2h-2V7z",clipRule:"evenodd"})}),re=()=>{const[g,N]=s.useState([]),[x,M]=s.useState([]),[b,F]=s.useState([]),[o,l]=s.useState([]),[w,n]=s.useState(!0),{user:a}=$(),[v,A]=s.useState(!1),[h,D]=s.useState(!1),[y,G]=s.useState("all"),[j,P]=s.useState("all"),p=s.useCallback(async()=>{n(!0);try{const[t,i,r,d]=await Promise.all([C.getTasks(),C.getUsers(),C.getProspects(),C.getMembers()]);N(t),M(i),F(r),l(d)}catch(t){console.error("Failed to fetch data",t)}finally{n(!1)}},[]);s.useEffect(()=>{p()},[p]);const u=s.useMemo(()=>{const t=new Map;return b.forEach(i=>t.set(i.id,{name:i.name,branch:i.branch})),o.forEach(i=>t.set(i.id,{name:i.name,branch:i.branch})),t},[b,o]),f=s.useMemo(()=>new Map(x.map(t=>[t.id,t.name])),[x]),O=s.useMemo(()=>a?a.role===c.Admin?x.filter(t=>t.role===c.Seller||t.role===c.Manager):x.filter(t=>(t.role===c.Seller||t.role===c.Manager)&&t.branch===a.branch):[],[x,a]),R=s.useMemo(()=>{if(!a)return[];let t=g;return a.role!==c.Admin&&(t=t.filter(r=>{const d=u.get(r.relatedTo);return(d==null?void 0:d.branch)===a.branch})),a.role===c.Seller&&(t=t.filter(r=>r.assignedTo===a.id)),t.filter(r=>{const d=y==="all"||r.status===y,m=j==="all"||r.assignedTo===j;return a.role===c.Admin||a.role===c.Manager?d&&m:d}).sort((r,d)=>new Date(d.dateTime).getTime()-new Date(r.dateTime).getTime())},[g,a,y,j,u]),T=()=>{A(!1),p()},I=async(t,i)=>{try{const r=await C.updateTask({...t,status:i});N(d=>d.map(m=>m.id===r.id?r:m))}catch(r){console.error("Failed to update task status",r)}};if(w)return e.jsx(z,{children:"Cargando tareas..."});const S=(a==null?void 0:a.role)===c.Admin||(a==null?void 0:a.role)===c.Manager;return e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap justify-between items-center mb-6 gap-2",children:[e.jsx("h1",{className:"text-3xl font-bold text-brand-text-primary",children:"Mis Tareas"}),e.jsxs("div",{className:"flex items-center gap-2",children:[S&&e.jsxs("button",{onClick:()=>D(!0),className:"flex items-center px-4 py-2 text-sm font-medium text-brand-text-primary bg-brand-border rounded-md shadow-sm hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-brand-primary",children:[e.jsx(X,{}),"Establecer Objetivos"]}),(S||(a==null?void 0:a.role)===c.Seller)&&e.jsxs("button",{onClick:()=>A(!0),className:"flex items-center px-4 py-2 text-sm font-medium text-white bg-brand-primary rounded-md hover:bg-brand-primary-hover focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-brand-primary",children:[e.jsx(Q,{}),"Crear Tarea"]})]})]}),e.jsx(z,{className:"mb-4 p-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 items-end",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"statusFilter",className:"block text-sm font-medium text-brand-text-secondary",children:"Estado"}),e.jsxs("select",{id:"statusFilter",value:y,onChange:t=>G(t.target.value),className:"mt-1 block w-full p-2 border border-brand-border bg-brand-surface text-brand-text-primary rounded-md shadow-sm focus:ring-brand-primary focus:border-brand-primary capitalize",children:[e.jsx("option",{value:"all",children:"Todos"}),U.map(t=>e.jsx("option",{value:t,className:"capitalize",children:t},t))]})]}),S&&e.jsxs("div",{children:[e.jsx("label",{htmlFor:"sellerFilter",className:"block text-sm font-medium text-brand-text-secondary",children:"Asignado a"}),e.jsxs("select",{id:"sellerFilter",value:j,onChange:t=>P(t.target.value),className:"mt-1 block w-full p-2 border border-brand-border bg-brand-surface text-brand-text-primary rounded-md shadow-sm focus:ring-brand-primary focus:border-brand-primary",children:[e.jsx("option",{value:"all",children:"Todos"}),O.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]})]})}),e.jsxs(z,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-brand-border",children:[e.jsx("thead",{className:"bg-gray-800",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-4 py-2 text-left text-xs font-bold text-gray-300 uppercase tracking-wider",children:"Estado"}),e.jsx("th",{scope:"col",className:"px-4 py-2 text-left text-xs font-bold text-gray-300 uppercase tracking-wider",children:"Tarea y Vencimiento"}),e.jsx("th",{scope:"col",className:"px-4 py-2 text-left text-xs font-bold text-gray-300 uppercase tracking-wider",children:"Contacto"}),S&&e.jsx("th",{scope:"col",className:"px-4 py-2 text-left text-xs font-bold text-gray-300 uppercase tracking-wider",children:"Asignado a"}),e.jsx("th",{scope:"col",className:"relative px-4 py-2",children:e.jsx("span",{className:"sr-only",children:"Completar"})})]})}),e.jsx("tbody",{className:"bg-brand-surface divide-y divide-brand-border",children:R.map(t=>{var i,r;return e.jsxs("tr",{className:`${t.status==="hecha"?"opacity-60":""}`,children:[e.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:e.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full capitalize ${J[t.status]||"bg-gray-700 text-gray-200"}`,children:t.status})}),e.jsxs("td",{className:"px-4 py-3 whitespace-nowrap",children:[e.jsx("div",{className:`text-sm font-medium ${t.status==="hecha"?"line-through text-brand-text-muted":"text-brand-text-primary"}`,children:t.title}),e.jsxs("div",{className:"text-xs text-brand-text-muted",children:[e.jsx("span",{className:"capitalize",children:t.type})," · ",new Date(t.dateTime).toLocaleString("es-AR",{year:"2-digit",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})]})]}),e.jsxs("td",{className:"px-4 py-3 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm text-brand-text-secondary",children:((i=u.get(t.relatedTo))==null?void 0:i.name)||"N/A"}),(a==null?void 0:a.role)===c.Admin&&e.jsx("div",{className:"text-xs text-brand-text-muted",children:((r=u.get(t.relatedTo))==null?void 0:r.branch)||"N/A"})]}),S&&e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-brand-text-secondary",children:f.get(t.assignedTo)||"N/A"}),e.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-right text-sm font-medium",children:[t.status===E.Pending&&e.jsx("button",{onClick:()=>I(t,E.Done),className:"text-green-400 hover:text-green-300",children:"Completar"}),t.status===E.Done&&e.jsx("button",{onClick:()=>I(t,E.Pending),className:"text-brand-accent hover:text-brand-accent-hover",children:"Reabrir"})]})]},t.id)})})]})}),R.length===0&&e.jsxs("div",{className:"text-center py-10",children:[e.jsx("h3",{className:"text-xl font-semibold text-brand-text-secondary",children:"No se encontraron tareas"}),e.jsx("p",{className:"text-brand-text-muted mt-2",children:"Intenta ajustar los filtros o crea una nueva tarea."})]})]}),e.jsx(K,{isOpen:v,onClose:()=>A(!1),onSuccess:T,sellers:O,prospects:b,members:o}),e.jsx(Y,{isOpen:h,onClose:()=>D(!1)})]})};export{re as default};
